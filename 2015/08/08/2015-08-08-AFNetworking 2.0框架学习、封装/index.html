<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="ArxqF9fNvIlxybI0naTgEy2PwvvvHyAs35iOfxJqL8o" />










  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="AFNetworking,iOS," />





  <link rel="alternate" href="/atom.xml" title="叶帆的技术博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description" content="最近项目从自己的网络框架换到了AFNetworking，集中学习了一下，并且进行了一次封装。首先先附上AFNetworking的地址:https://github.com/AFNetworking/AFNetworking，star已经19078，确实ios中性能最好最强大的网络库。以及官方的文档AFNetworking-2.0-Migration-Guide
使用方法推荐Cocoapods
Po">
<meta property="og:type" content="article">
<meta property="og:title" content="AFNetworking学习、封装">
<meta property="og:url" content="http://yeziahehe.com/2015/08/08/2015-08-08-AFNetworking 2.0框架学习、封装/index.html">
<meta property="og:site_name" content="叶帆的技术博客">
<meta property="og:description" content="最近项目从自己的网络框架换到了AFNetworking，集中学习了一下，并且进行了一次封装。首先先附上AFNetworking的地址:https://github.com/AFNetworking/AFNetworking，star已经19078，确实ios中性能最好最强大的网络库。以及官方的文档AFNetworking-2.0-Migration-Guide
使用方法推荐Cocoapods
Po">
<meta property="og:updated_time" content="2015-12-16T15:17:06.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AFNetworking学习、封装">
<meta name="twitter:description" content="最近项目从自己的网络框架换到了AFNetworking，集中学习了一下，并且进行了一次封装。首先先附上AFNetworking的地址:https://github.com/AFNetworking/AFNetworking，star已经19078，确实ios中性能最好最强大的网络库。以及官方的文档AFNetworking-2.0-Migration-Guide
使用方法推荐Cocoapods
Po">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'hide',
    motion: true
  };
</script>

  <title> AFNetworking学习、封装 | 叶帆的技术博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <a href="https://github.com/yeziahehe"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">叶帆的技术博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                AFNetworking学习、封装
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2015-08-08T23:15:11+08:00" content="2015-08-08">
              2015-08-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/08/2015-08-08-AFNetworking 2.0框架学习、封装/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/08/2015-08-08-AFNetworking 2.0框架学习、封装/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><p>最近项目从自己的网络框架换到了AFNetworking，集中学习了一下，并且进行了一次封装。<br>首先先附上AFNetworking的地址:<a href="https://github.com/AFNetworking/AFNetworking" target="_blank" rel="external">https://github.com/AFNetworking/AFNetworking</a><br>，star已经19078，确实ios中性能最好最强大的网络库。以及官方的文档<a href="https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-2.0-Migration-Guide" target="_blank" rel="external">AFNetworking-2.0-Migration-Guide</a></p>
<p>使用方法推荐<a href="http://code4app.com/article/cocoapods-install-usage" target="_blank" rel="external">Cocoapods</a></p>
<p>Podfile</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">platform :ios, '7.0'</span><br><span class="line">pod "AFNetworking", "~&gt; 2.0"</span><br></pre></td></tr></table></figure>
<p>下面主要介绍的AFNetworking 2.0的一些新特性:</p>
<h3 id="1-AFURLSessionManager"><a href="#1-AFURLSessionManager" class="headerlink" title="1.AFURLSessionManager"></a>1.AFURLSessionManager</h3><p>AFURLSessionManager是2.0的新特性，是基于NSURLSessionConfiguration(IOS 7.0+, MAC OX10_9+)的。</p>
<p>我们主要借助于这个类进行一次自己的封装，首先我们先来学习一下这个类。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AFURLSessionManager.h</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Copyright (c) 2013-2015 AFNetworking (http://afnetworking.com)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Permission is hereby granted, free of charge, to any person obtaining a copy</span></span><br><span class="line"><span class="comment">// of this software and associated documentation files (the "Software"), to deal</span></span><br><span class="line"><span class="comment">// in the Software without restriction, including without limitation the rights</span></span><br><span class="line"><span class="comment">// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></span><br><span class="line"><span class="comment">// copies of the Software, and to permit persons to whom the Software is</span></span><br><span class="line"><span class="comment">// furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// The above copyright notice and this permission notice shall be included in</span></span><br><span class="line"><span class="comment">// all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span><br><span class="line"><span class="comment">// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span><br><span class="line"><span class="comment">// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></span><br><span class="line"><span class="comment">// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span><br><span class="line"><span class="comment">// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></span><br><span class="line"><span class="comment">// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span></span><br><span class="line"><span class="comment">// THE SOFTWARE.</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#import <span class="title">"AFURLResponseSerialization.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"AFURLRequestSerialization.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"AFSecurityPolicy.h"</span></span></span><br><span class="line"><span class="preprocessor">#import <span class="title">"AFNetworkReachabilityManager.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> `AFURLSessionManager` creates and manages an `NSURLSession` object based on a specified `NSURLSessionConfiguration` object, which conforms to `&lt;NSURLSessionTaskDelegate&gt;`, `&lt;NSURLSessionDataDelegate&gt;`, `&lt;NSURLSessionDownloadDelegate&gt;`, and `&lt;NSURLSessionDelegate&gt;`.</span><br><span class="line"></span><br><span class="line"> `AFURLSessionManager` 基于指定的 `NSURLSessionConfiguration` 创建并管理一个 `NSURLSession` 对象</span><br><span class="line"> 遵守 `NSURLSessionTaskDelegate`、`NSURLSessionDataDelegate`、`NSURLSessionDownloadDelegate` 和 `NSURLSessionDelegate` 协议</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ## Subclassing Notes - 子类注意事项</span><br><span class="line"></span><br><span class="line"> This is the base class for `AFHTTPSessionManager`, which adds functionality specific to making HTTP requests. If you are looking to extend `AFURLSessionManager` specifically for HTTP, consider subclassing `AFHTTPSessionManager` instead.</span><br><span class="line"></span><br><span class="line"> 本类是 `AFHTTPSessionManager` 类的基类</span><br><span class="line"> `AFHTTPSessionManager` 针对 HTTP 请求添加了特定的方法</span><br><span class="line"> 如果希望针对 HTTP 协议扩展网络访问功能，建议从 `AFHTTPSessionManager` 派生子类</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ## NSURLSession &amp; NSURLSessionTask Delegate Methods - NSURLSession 和 NSURLSessionTask 代理方法</span><br><span class="line"></span><br><span class="line"> `AFURLSessionManager` implements the following delegate methods:</span><br><span class="line"> `AFURLSessionManager` 实现了以下代理方法：</span><br><span class="line"></span><br><span class="line"> ### `NSURLSessionDelegate`</span><br><span class="line"></span><br><span class="line"> - `URLSession:didBecomeInvalidWithError:`</span><br><span class="line"> - `URLSession:didReceiveChallenge:completionHandler:`</span><br><span class="line"> - `URLSessionDidFinishEventsForBackgroundURLSession:`</span><br><span class="line"></span><br><span class="line"> ### `NSURLSessionTaskDelegate`</span><br><span class="line"></span><br><span class="line"> - `URLSession:willPerformHTTPRedirection:newRequest:completionHandler:`</span><br><span class="line"> - `URLSession:task:didReceiveChallenge:completionHandler:`</span><br><span class="line"> - `URLSession:task:didSendBodyData:totalBytesSent:totalBytesExpectedToSend:`</span><br><span class="line"> - `URLSession:task:didCompleteWithError:`</span><br><span class="line"></span><br><span class="line"> ### `NSURLSessionDataDelegate`</span><br><span class="line"></span><br><span class="line"> - `URLSession:dataTask:didReceiveResponse:completionHandler:`</span><br><span class="line"> - `URLSession:dataTask:didBecomeDownloadTask:`</span><br><span class="line"> - `URLSession:dataTask:didReceiveData:`</span><br><span class="line"> - `URLSession:dataTask:willCacheResponse:completionHandler:`</span><br><span class="line"></span><br><span class="line"> ### `NSURLSessionDownloadDelegate`</span><br><span class="line"></span><br><span class="line"> - `URLSession:downloadTask:didFinishDownloadingToURL:`</span><br><span class="line"> - `URLSession:downloadTask:didWriteData:totalBytesWritten:totalBytesWritten:totalBytesExpectedToWrite:`</span><br><span class="line"> - `URLSession:downloadTask:didResumeAtOffset:expectedTotalBytes:`</span><br><span class="line"></span><br><span class="line"> If any of these methods are overridden in a subclass, they _must_ call the `super` implementation first.</span><br><span class="line"> 如果在子类中重写了这些方法，必须先调用 `super` 的实现</span><br><span class="line"></span><br><span class="line"> ## Network Reachability Monitoring - 网络连接状态监听</span><br><span class="line"></span><br><span class="line"> Network reachability status and change monitoring is available through the `reachabilityManager` property. Applications may choose to monitor network reachability conditions in order to prevent or suspend any outbound requests. See `AFNetworkReachabilityManager` for more details.</span><br><span class="line"></span><br><span class="line"> 可以通过 `reachabilityManager` 属性监听网络连接状态是否可用</span><br><span class="line"> 应用程序通过监听网络连接状态条件，可以阻止或暂停出站请求</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ## NSCoding Caveats - NSCoding 注意事项</span><br><span class="line"></span><br><span class="line"> - Encoded managers do not include any block properties. Be sure to set delegate callback blocks when using `-initWithCoder:` or `NSKeyedUnarchiver`.</span><br><span class="line"></span><br><span class="line"> 被编码的管理器不包含任何 block 属性。如果使用 `-initWithCoder:` 或者 `NSKeyedUnarchiver`，需要设置代理回调的 block</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ## NSCopying Caveats － NSCopying 注意事项</span><br><span class="line"></span><br><span class="line"> - `-copy` and `-copyWithZone:` return a new manager with a new `NSURLSession` created from the configuration of the original.</span><br><span class="line"> - Operation copies do not include any delegate callback blocks, as they often strongly captures a reference to `self`, which would otherwise have the unintuitive side-effect of pointing to the _original_ session manager when copied.</span><br><span class="line"></span><br><span class="line"> `-copy` 和 `-copyWithZone:` 方法返回一个新的管理器，并新建一个 `NSURLSession`</span><br><span class="line"> `NSURLSession` 的配置使用原有配置</span><br><span class="line"> 操作副本不包含任何代理回调 block，这是因为在 block 中经常会出现对 `self` 的强引用，而如果拷贝 block，会在拷贝时将指针指向原有的 session 管理器</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @warning Managers for background sessions must be owned for the duration of their use. This can be accomplished by creating an application-wide or shared singleton instance.</span><br><span class="line"> 后台会话的管理器必须被长期持有，以保证有足够的时间完成工作，可以创建一个应用程序范围的管理器或者共享的单例来实现。</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#if (defined(__IPHONE_OS_VERSION_MAX_ALLOWED) &amp;&amp; __IPHONE_OS_VERSION_MAX_ALLOWED &gt;= 70000) || (defined(__MAC_OS_X_VERSION_MAX_ALLOWED) &amp;&amp; __MAC_OS_X_VERSION_MAX_ALLOWED &gt;= 1090)</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AFURLSessionManager</span> : <span class="title">NSObject</span> &lt;<span class="title">NSURLSessionDelegate</span>, <span class="title">NSURLSessionTaskDelegate</span>, <span class="title">NSURLSessionDataDelegate</span>, <span class="title">NSURLSessionDownloadDelegate</span>, <span class="title">NSSecureCoding</span>, <span class="title">NSCopying</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The managed session.</span><br><span class="line"> 被管理的网络会话</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSURLSession</span> *session;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The operation queue on which delegate callbacks are run.</span><br><span class="line"> 代理回调运行的操作队列</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSOperationQueue</span> *operationQueue;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Responses sent from the server in data tasks created with `dataTaskWithRequest:success:failure:` and run using the `GET` / `POST` / et al. convenience methods are automatically validated and serialized by the response serializer. By default, this property is set to an instance of `AFJSONResponseSerializer`.</span><br><span class="line"></span><br><span class="line"> 使用 `GET` / `POST` 等常用方法通过 `dataTaskWithRequest:success:failure:` 数据任务创建的由服务器返回的响应</span><br><span class="line"> 响应数据会被自动验证并由响应序列化器反序列化</span><br><span class="line"> 默认情况下，该属性是 `AFJSONResponseSerializer` 的实例(默认服务器返回的是 JSON 数据)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @warning `responseSerializer` must not be `nil`.</span><br><span class="line"> `responseSerializer` 不能为nil</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="keyword">id</span> &lt;AFURLResponseSerialization&gt; responseSerializer;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-------------------------------</span></span><br><span class="line"><span class="comment">/// @name Managing Security Policy - 管理安全策略</span></span><br><span class="line"><span class="comment">///-------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The security policy used by created request operations to evaluate server trust for secure connections. `AFURLSessionManager` uses the `defaultPolicy` unless otherwise specified.</span><br><span class="line"></span><br><span class="line"> 用于创建请求操作的安全策略，以建立服务器信任的安全连接</span><br><span class="line"> 除非特殊指定 `AFURLSessionManager` 使用 `defaultPolicy`</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) AFSecurityPolicy *securityPolicy;</span><br><span class="line"></span><br><span class="line"><span class="comment">///--------------------------------------</span></span><br><span class="line"><span class="comment">/// @name Monitoring Network Reachability - 监听网络连接状态</span></span><br><span class="line"><span class="comment">///--------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The network reachability manager. `AFURLSessionManager` uses the `sharedManager` by default.</span><br><span class="line"></span><br><span class="line"> 网络连接管理器</span><br><span class="line"> `AFURLSessionManager` 默认使用 `sharedManager`</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readwrite</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) AFNetworkReachabilityManager *reachabilityManager;</span><br><span class="line"></span><br><span class="line"><span class="comment">///----------------------------</span></span><br><span class="line"><span class="comment">/// @name Getting Session Tasks - 获取会话任务</span></span><br><span class="line"><span class="comment">///----------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The data, upload, and download tasks currently run by the managed session.</span><br><span class="line"> 被管理的会话当前运行的数据、上传和下载任务</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSArray</span> *tasks;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The data tasks currently run by the managed session.</span><br><span class="line"> 被管理的会话当前运行的数据任务</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSArray</span> *dataTasks;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The upload tasks currently run by the managed session.</span><br><span class="line"> 被管理的会话当前运行的上传任务</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSArray</span> *uploadTasks;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The download tasks currently run by the managed session.</span><br><span class="line"> 被管理的会话当前运行的下载任务</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>, <span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSArray</span> *downloadTasks;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-------------------------------</span></span><br><span class="line"><span class="comment">/// @name Managing Callback Queues - 管理回调队列</span></span><br><span class="line"><span class="comment">///-------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The dispatch queue for `completionBlock`. If `NULL` (default), the main queue is used.</span><br><span class="line"></span><br><span class="line"> `completionBlock` 的调度队列</span><br><span class="line"> 如果为 `NULL`（默认），使用主队列</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">dispatch_queue_t</span> completionQueue;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The dispatch group for `completionBlock`. If `NULL` (default), a private dispatch group is used.</span><br><span class="line"></span><br><span class="line"> `completionBlock` 的调度组</span><br><span class="line"> 如果为 `NULL`（默认），使用一个私有调度组</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) dispatch_group_t completionGroup;</span><br><span class="line"></span><br><span class="line"><span class="comment">///---------------------------------</span></span><br><span class="line"><span class="comment">/// @name Working Around System Bugs - 处理系统 Bugs</span></span><br><span class="line"><span class="comment">///---------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Whether to attempt to retry creation of upload tasks for background sessions when initial call returns `nil`. `NO` by default.</span><br><span class="line"></span><br><span class="line"> 如果初始调用返回 `nil`，是否为后台会话重新创建上传任务</span><br><span class="line"> 默认为 `NO`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> bug: As of iOS 7.0, there is a bug where upload tasks created for background tasks are sometimes `nil`. As a workaround, if this property is `YES`, AFNetworking will follow Apple's recommendation to try creating the task again.</span><br><span class="line"> &lt;p&gt;BUG&lt;/p&gt;</span><br><span class="line"></span><br><span class="line"> 在 iOS 7.0中，有时会无法为后台任务创建上传任务，而只是得到 `nil`</span><br><span class="line"> 作为解决办法，如果将此属性设置为 `YES`，AFNetworking 将按照苹果的建议，尝试再次创建任务</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @see https://github.com/AFNetworking/AFNetworking/issues/1675</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> attemptsToRecreateUploadTasksForBackgroundSessions;</span><br><span class="line"></span><br><span class="line"><span class="comment">///---------------------</span></span><br><span class="line"><span class="comment">/// @name Initialization - 初始化</span></span><br><span class="line"><span class="comment">///---------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates and returns a manager for a session created with the specified configuration. This is the designated initializer.</span><br><span class="line"></span><br><span class="line"> 使用指定的配置为网络会话创建并返回一个管理器</span><br><span class="line"> 这是指定的初始化方法</span><br><span class="line"></span><br><span class="line"> @param configuration The configuration used to create the managed session.</span><br><span class="line"> 用于创建管理的网络会话的配置</span><br><span class="line"></span><br><span class="line"> @return A manager for a newly-created session.</span><br><span class="line"> 新创建的网络会话管理器</span><br><span class="line"> */</span></span><br><span class="line">- (instancetype)initWithSessionConfiguration:(<span class="built_in">NSURLSessionConfiguration</span> *)configuration <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Invalidates the managed session, optionally canceling pending tasks.</span><br><span class="line"></span><br><span class="line"> 使管理的会话无效</span><br><span class="line"> 可用于取消尚未完成的任务</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param cancelPendingTasks Whether or not to cancel pending tasks.</span><br><span class="line"> 是否取消尚未完成的任务</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)invalidateSessionCancelingTasks:(<span class="built_in">BOOL</span>)cancelPendingTasks;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-------------------------</span></span><br><span class="line"><span class="comment">/// @name Running Data Tasks - 运行数据任务</span></span><br><span class="line"><span class="comment">///-------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates an `NSURLSessionDataTask` with the specified request.</span><br><span class="line"> 使用指定的请求创建一个 `NSURLSessionDataTask`</span><br><span class="line"></span><br><span class="line"> @param request The HTTP request for the request.</span><br><span class="line"> HTTP 请求</span><br><span class="line"> @param completionHandler A block object to be executed when the task finishes. This block has no return value and takes three arguments: the server response, the response object created by that serializer, and the error that occurred, if any.</span><br><span class="line"></span><br><span class="line"> 任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有三个参数：服务器响应，序列化器创建的响应对象，错误(如果有)</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSURLSessionDataTask</span> *)dataTaskWithRequest:(<span class="built_in">NSURLRequest</span> *)request</span><br><span class="line">                            completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span> *response, <span class="keyword">id</span> responseObject, <span class="built_in">NSError</span> *error))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">///---------------------------</span></span><br><span class="line"><span class="comment">/// @name Running Upload Tasks - 运行上传任务</span></span><br><span class="line"><span class="comment">///---------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates an `NSURLSessionUploadTask` with the specified request for a local file.</span><br><span class="line"> 使用指定的请求和一个本地文件，创建一个 `NSURLSessionUploadTask`</span><br><span class="line"></span><br><span class="line"> @param request The HTTP request for the request.</span><br><span class="line"> HTTP 请求</span><br><span class="line"> @param fileURL A URL to the local file to be uploaded.</span><br><span class="line"> 要上传的本地文件的 URL</span><br><span class="line"> @param progress A progress object monitoring the current upload progress.</span><br><span class="line"> 监听当前上传进度的进度对象</span><br><span class="line"> @param completionHandler A block object to be executed when the task finishes. This block has no return value and takes three arguments: the server response, the response object created by that serializer, and the error that occurred, if any.</span><br><span class="line"></span><br><span class="line"> 任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有三个参数：服务器响应，序列化器创建的响应对象，错误(如果有)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @see `attemptsToRecreateUploadTasksForBackgroundSessions`</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSURLSessionUploadTask</span> *)uploadTaskWithRequest:(<span class="built_in">NSURLRequest</span> *)request</span><br><span class="line">                                         fromFile:(<span class="built_in">NSURL</span> *)fileURL</span><br><span class="line">                                         progress:(<span class="built_in">NSProgress</span> * __autoreleasing *)progress</span><br><span class="line">                                completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span> *response, <span class="keyword">id</span> responseObject, <span class="built_in">NSError</span> *error))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates an `NSURLSessionUploadTask` with the specified request for an HTTP body.</span><br><span class="line"> 使用指定的请求和二进制数据，创建一个 `NSURLSessionUploadTask`</span><br><span class="line"></span><br><span class="line"> @param request The HTTP request for the request.</span><br><span class="line"> HTTP 请求</span><br><span class="line"> @param bodyData A data object containing the HTTP body to be uploaded.</span><br><span class="line"> 要上传的 NSData 对象</span><br><span class="line"> @param progress A progress object monitoring the current upload progress.</span><br><span class="line"> 监听当前上传进度的进度对象</span><br><span class="line"> @param completionHandler A block object to be executed when the task finishes. This block has no return value and takes three arguments: the server response, the response object created by that serializer, and the error that occurred, if any.</span><br><span class="line"></span><br><span class="line"> 任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有三个参数：服务器响应，序列化器创建的响应对象，错误(如果有)</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSURLSessionUploadTask</span> *)uploadTaskWithRequest:(<span class="built_in">NSURLRequest</span> *)request</span><br><span class="line">                                         fromData:(<span class="built_in">NSData</span> *)bodyData</span><br><span class="line">                                         progress:(<span class="built_in">NSProgress</span> * __autoreleasing *)progress</span><br><span class="line">                                completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span> *response, <span class="keyword">id</span> responseObject, <span class="built_in">NSError</span> *error))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates an `NSURLSessionUploadTask` with the specified streaming request.</span><br><span class="line"> 使用指定的流请求，创建一个 `NSURLSessionUploadTask`</span><br><span class="line"></span><br><span class="line"> @param request The HTTP request for the request.</span><br><span class="line"> HTTP 请求</span><br><span class="line"> @param progress A progress object monitoring the current upload progress.</span><br><span class="line"> 监听当前上传进度的进度对象</span><br><span class="line"> @param completionHandler A block object to be executed when the task finishes. This block has no return value and takes three arguments: the server response, the response object created by that serializer, and the error that occurred, if any.</span><br><span class="line"></span><br><span class="line"> 任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有三个参数：服务器响应，序列化器创建的响应对象，错误(如果有)</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSURLSessionUploadTask</span> *)uploadTaskWithStreamedRequest:(<span class="built_in">NSURLRequest</span> *)request</span><br><span class="line">                                                 progress:(<span class="built_in">NSProgress</span> * __autoreleasing *)progress</span><br><span class="line">                                        completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span> *response, <span class="keyword">id</span> responseObject, <span class="built_in">NSError</span> *error))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-----------------------------</span></span><br><span class="line"><span class="comment">/// @name Running Download Tasks - 运行下载任务</span></span><br><span class="line"><span class="comment">///-----------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates an `NSURLSessionDownloadTask` with the specified request.</span><br><span class="line"> 使用指定的请求，创建一个 `NSURLSessionDownloadTask`</span><br><span class="line"></span><br><span class="line"> @param request The HTTP request for the request.</span><br><span class="line"> HTTP 请求</span><br><span class="line"> @param progress A progress object monitoring the current download progress.</span><br><span class="line"> 监听当前下载进度的进度对象</span><br><span class="line"> @param destination A block object to be executed in order to determine the destination of the downloaded file. This block takes two arguments, the target path &amp; the server response, and returns the desired file URL of the resulting download. The temporary file used during the download will be automatically deleted after being moved to the returned URL.</span><br><span class="line"></span><br><span class="line"> 确定保存下载文件目标位置的 block 对象</span><br><span class="line"> 该 block 有两个参数：目标路径和服务器响应</span><br><span class="line"> 返回保存下载文件目标位置的 URL</span><br><span class="line"> 当将下载的临时文件移动至返回的 URL 后，临时文件会被自动删除</span><br><span class="line"></span><br><span class="line"> @param completionHandler A block to be executed when a task finishes. This block has no return value and takes three arguments: the server response, the path of the downloaded file, and the error describing the network or parsing error that occurred, if any.</span><br><span class="line"></span><br><span class="line"> 任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有三个参数：服务器响应，下载的文件路径，错误(如果有)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @warning If using a background `NSURLSessionConfiguration` on iOS, these blocks will be lost when the app is terminated. Background sessions may prefer to use `-setDownloadTaskDidFinishDownloadingBlock:` to specify the URL for saving the downloaded file, rather than the destination block of this method.</span><br><span class="line"> 如果使用 iOS 后台的 `NSURLSessionConfiguration`，应用程序被终止后，这些 block 都将会丢失。针对后台会话建议使用 `-setDownloadTaskDidFinishDownloadingBlock:` 指定保存下载文件的 URL，而不要使用此方法的 destination block</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSURLSessionDownloadTask</span> *)downloadTaskWithRequest:(<span class="built_in">NSURLRequest</span> *)request</span><br><span class="line">                                             progress:(<span class="built_in">NSProgress</span> * __autoreleasing *)progress</span><br><span class="line">                                          destination:(<span class="built_in">NSURL</span> * (^)(<span class="built_in">NSURL</span> *targetPath, <span class="built_in">NSURLResponse</span> *response))destination</span><br><span class="line">                                    completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSURL</span> *filePath, <span class="built_in">NSError</span> *error))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Creates an `NSURLSessionDownloadTask` with the specified resume data.</span><br><span class="line"> 使用指定的续传数据，创建一个 `NSURLSessionDownloadTask`</span><br><span class="line"></span><br><span class="line"> @param resumeData The data used to resume downloading.</span><br><span class="line"> 用于断点续传的续传数据</span><br><span class="line"> @param progress A progress object monitoring the current download progress.</span><br><span class="line"> 监听当前下载进度的进度对象</span><br><span class="line"> @param destination A block object to be executed in order to determine the destination of the downloaded file. This block takes two arguments, the target path &amp; the server response, and returns the desired file URL of the resulting download. The temporary file used during the download will be automatically deleted after being moved to the returned URL.</span><br><span class="line"></span><br><span class="line"> 确定保存下载文件目标位置的 block 对象</span><br><span class="line"> 该 block 有两个参数：目标路径和服务器响应</span><br><span class="line"> 返回保存下载文件目标位置的 URL</span><br><span class="line"> 当将下载的临时文件移动至返回的 URL 后，临时文件会被自动删除</span><br><span class="line"></span><br><span class="line"> @param completionHandler A block to be executed when a task finishes. This block has no return value and takes three arguments: the server response, the path of the downloaded file, and the error describing the network or parsing error that occurred, if any.</span><br><span class="line"></span><br><span class="line"> 任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有三个参数：服务器响应，下载的文件路径，错误(如果有)</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSURLSessionDownloadTask</span> *)downloadTaskWithResumeData:(<span class="built_in">NSData</span> *)resumeData</span><br><span class="line">                                                progress:(<span class="built_in">NSProgress</span> * __autoreleasing *)progress</span><br><span class="line">                                             destination:(<span class="built_in">NSURL</span> * (^)(<span class="built_in">NSURL</span> *targetPath, <span class="built_in">NSURLResponse</span> *response))destination</span><br><span class="line">                                       completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSURL</span> *filePath, <span class="built_in">NSError</span> *error))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">///---------------------------------</span></span><br><span class="line"><span class="comment">/// @name Getting Progress for Tasks - 获得任务进度</span></span><br><span class="line"><span class="comment">///---------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Returns the upload progress of the specified task.</span><br><span class="line"> 返回指定任务的上传进度</span><br><span class="line"></span><br><span class="line"> @param uploadTask The session upload task. Must not be `nil`.</span><br><span class="line"> 会话的上传任务，不能为空</span><br><span class="line"></span><br><span class="line"> @return An `NSProgress` object reporting the upload progress of a task, or `nil` if the progress is unavailable.</span><br><span class="line"> 一个 `NSProgress` 对象报告任务的上传进度，如果进度不可用，返回 `nil`</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSProgress</span> *)uploadProgressForTask:(<span class="built_in">NSURLSessionUploadTask</span> *)uploadTask;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Returns the download progress of the specified task.</span><br><span class="line"> 返回指定任务的下载进度</span><br><span class="line"></span><br><span class="line"> @param downloadTask The session download task. Must not be `nil`.</span><br><span class="line"> 会话的下载任务，不能为空</span><br><span class="line"></span><br><span class="line"> @return An `NSProgress` object reporting the download progress of a task, or `nil` if the progress is unavailable.</span><br><span class="line"> 一个 `NSProgress` 对象报告任务的下载进度，如果进度不可用，返回 `nil`</span><br><span class="line"> */</span></span><br><span class="line">- (<span class="built_in">NSProgress</span> *)downloadProgressForTask:(<span class="built_in">NSURLSessionDownloadTask</span> *)downloadTask;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-----------------------------------------</span></span><br><span class="line"><span class="comment">/// @name Setting Session Delegate Callbacks - 设置会话代理回调</span></span><br><span class="line"><span class="comment">///-----------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when the managed session becomes invalid, as handled by the `NSURLSessionDelegate` method `URLSession:didBecomeInvalidWithError:`.</span><br><span class="line"></span><br><span class="line"> 设置当管理的会话无效时执行的 block</span><br><span class="line"> 在 `NSURLSessionDelegate` 的 `URLSession:didBecomeInvalidWithError:` 方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when the managed session becomes invalid. The block has no return value, and takes two arguments: the session, and the error related to the cause of invalidation.</span><br><span class="line"></span><br><span class="line"> 当管理的会话无效时执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 该 block 有两个参数：会话和导致会话无效相关的错误</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setSessionDidBecomeInvalidBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSError</span> *error))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a connection level authentication challenge has occurred, as handled by the `NSURLSessionDelegate` method `URLSession:didReceiveChallenge:completionHandler:`.</span><br><span class="line"></span><br><span class="line"> 设置当连接需要身份验证质询时执行的 block</span><br><span class="line"> 在 `NSURLSessionDelegate` 的 `URLSession:didReceiveChallenge:completionHandler:` 方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a connection level authentication challenge has occurred. The block returns the disposition of the authentication challenge, and takes three arguments: the session, the authentication challenge, and a pointer to the credential that should be used to resolve the challenge.</span><br><span class="line"></span><br><span class="line"> 当连接需要身份验证质询时执行的 block 对象</span><br><span class="line"> 该 block 返回身份验证的配置情况</span><br><span class="line"> 该 block 有三个参数：会话，身份验证质询和一个指向凭据的指针，该凭据用于解决身份验证</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setSessionDidReceiveAuthenticationChallengeBlock:(<span class="built_in">NSURLSessionAuthChallengeDisposition</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLAuthenticationChallenge</span> *challenge, <span class="built_in">NSURLCredential</span> * __autoreleasing *credential))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">///--------------------------------------</span></span><br><span class="line"><span class="comment">/// @name Setting Task Delegate Callbacks - 设置任务代理回调</span></span><br><span class="line"><span class="comment">///--------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a task requires a new request body stream to send to the remote server, as handled by the `NSURLSessionTaskDelegate` method `URLSession:task:needNewBodyStream:`.</span><br><span class="line"></span><br><span class="line"> 设置一个请求体二进制流发送至远程服务器时执行的 block</span><br><span class="line"> 在 `NSURLSessionTaskDelegate` 的 `URLSession:task:needNewBodyStream:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a task requires a new request body stream.</span><br><span class="line"></span><br><span class="line"> 任务请求一个新请求体二进制流时执行的 block 对象</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setTaskNeedNewBodyStreamBlock:(<span class="built_in">NSInputStream</span> * (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionTask</span> *task))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when an HTTP request is attempting to perform a redirection to a different URL, as handled by the `NSURLSessionTaskDelegate` method `URLSession:willPerformHTTPRedirection:newRequest:completionHandler:`.</span><br><span class="line"></span><br><span class="line"> 设置 HTTP 请求尝试重定向到其他 URL 时执行的 block</span><br><span class="line"> 在 `NSURLSessionTaskDelegate` 的 `URLSession:willPerformHTTPRedirection:newRequest:completionHandler:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when an HTTP request is attempting to perform a redirection to a different URL. The block returns the request to be made for the redirection, and takes four arguments: the session, the task, the redirection response, and the request corresponding to the redirection response.</span><br><span class="line"></span><br><span class="line"> 当 HTTP 请求尝试重定向到其他 URL 时执行的 block 对象</span><br><span class="line"> 该 block 返回导致重定向的请求 NSURLRequest</span><br><span class="line"> 接收四个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        重定向响应</span><br><span class="line">        要重定向的请求</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setTaskWillPerformHTTPRedirectionBlock:(<span class="built_in">NSURLRequest</span> * (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionTask</span> *task, <span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSURLRequest</span> *request))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a session task has received a request specific authentication challenge, as handled by the `NSURLSessionTaskDelegate` method `URLSession:task:didReceiveChallenge:completionHandler:`.</span><br><span class="line"></span><br><span class="line"> 设置接收到特定身份验证质询时执行的 block</span><br><span class="line"> HTTPS 访问需要</span><br><span class="line"> 在 `NSURLSessionTaskDelegate` 的 `URLSession:task:didReceiveChallenge:completionHandler:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a session task has received a request specific authentication challenge. The block returns the disposition of the authentication challenge, and takes four arguments: the session, the task, the authentication challenge, and a pointer to the credential that should be used to resolve the challenge.</span><br><span class="line"></span><br><span class="line"> 当会话任务接收到特定身份验证质询时执行的 block 对象</span><br><span class="line"> 该 block 返回对身份验证请求质询的处置</span><br><span class="line"> 接收四个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        身份验证质询</span><br><span class="line">        指向解决验证需要使用凭据的指针</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setTaskDidReceiveAuthenticationChallengeBlock:(<span class="built_in">NSURLSessionAuthChallengeDisposition</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionTask</span> *task, <span class="built_in">NSURLAuthenticationChallenge</span> *challenge, <span class="built_in">NSURLCredential</span> * __autoreleasing *credential))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed periodically to track upload progress, as handled by the `NSURLSessionTaskDelegate` method `URLSession:task:didSendBodyData:totalBytesSent:totalBytesExpectedToSend:`.</span><br><span class="line"></span><br><span class="line"> 设置跟踪上传进度要执行的 block</span><br><span class="line"> 在 `NSURLSessionTaskDelegate` 的 `URLSession:task:didSendBodyData:totalBytesSent:totalBytesExpectedToSend:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be called when an undetermined number of bytes have been uploaded to the server. This block has no return value and takes five arguments: the session, the task, the number of bytes written since the last time the upload progress block was called, the total bytes written, and the total bytes expected to be written during the request, as initially determined by the length of the HTTP body. This block may be called multiple times, and will execute on the main thread.</span><br><span class="line"></span><br><span class="line"> 向服务器上传一定数量的字节后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收五个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        从上次上传进度 block 被调用后上传的字节数 － 本次上传字节数</span><br><span class="line">        已经上传的字节数</span><br><span class="line">        请求预期上传的总字节数，由 HTTP body 的长度确定</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 该 block 可能会被调用多次，并在主线程上执行</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setTaskDidSendBodyDataBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionTask</span> *task, int64_t bytesSent, int64_t totalBytesSent, int64_t totalBytesExpectedToSend))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed as the last message related to a specific task, as handled by the `NSURLSessionTaskDelegate` method `URLSession:task:didCompleteWithError:`.</span><br><span class="line"></span><br><span class="line"> 设置特定任务完成后执行的 block</span><br><span class="line"> 在 `NSURLSessionTaskDelegate` 的 `URLSession:task:didCompleteWithError:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a session task is completed. The block has no return value, and takes three arguments: the session, the task, and any error that occurred in the process of executing the task.</span><br><span class="line"></span><br><span class="line"> 会话任务完成后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收三个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        任务执行过程中出现的错误</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setTaskDidCompleteBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionTask</span> *task, <span class="built_in">NSError</span> *error))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-------------------------------------------</span></span><br><span class="line"><span class="comment">/// @name Setting Data Task Delegate Callbacks - 设置数据任务代理回调</span></span><br><span class="line"><span class="comment">///-------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a data task has received a response, as handled by the `NSURLSessionDataDelegate` method `URLSession:dataTask:didReceiveResponse:completionHandler:`.</span><br><span class="line"></span><br><span class="line"> 设置数据任务接收到响应时执行的 block</span><br><span class="line"> 在 `NSURLSessionDataDelegate` 的 `URLSession:dataTask:didReceiveResponse:completionHandler:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a data task has received a response. The block returns the disposition of the session response, and takes three arguments: the session, the data task, and the received response.</span><br><span class="line"></span><br><span class="line"> 数据任务接收到响应时执行的 block 对象</span><br><span class="line"> 该 block 返回对会话响应的处置</span><br><span class="line"> 接收三个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        接收到的响应</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDataTaskDidReceiveResponseBlock:(<span class="built_in">NSURLSessionResponseDisposition</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDataTask</span> *dataTask, <span class="built_in">NSURLResponse</span> *response))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a data task has become a download task, as handled by the `NSURLSessionDataDelegate` method `URLSession:dataTask:didBecomeDownloadTask:`.</span><br><span class="line"></span><br><span class="line"> 设置数据任务成为下载任务时执行的 block</span><br><span class="line"> 在 `NSURLSessionDataDelegate` 的 `URLSession:dataTask:didBecomeDownloadTask:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a data task has become a download task. The block has no return value, and takes three arguments: the session, the data task, and the download task it has become.</span><br><span class="line"></span><br><span class="line"> 数据任务成为下载任务时执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收三个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        成为的下载任务</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDataTaskDidBecomeDownloadTaskBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDataTask</span> *dataTask, <span class="built_in">NSURLSessionDownloadTask</span> *downloadTask))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a data task receives data, as handled by the `NSURLSessionDataDelegate` method `URLSession:dataTask:didReceiveData:`.</span><br><span class="line"></span><br><span class="line"> 设置数据任务接收到数据时执行的 block</span><br><span class="line"> 在 `NSURLSessionDataDelegate` 的 `URLSession:dataTask:didReceiveData:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be called when an undetermined number of bytes have been downloaded from the server. This block has no return value and takes three arguments: the session, the data task, and the data received. This block may be called multiple times, and will execute on the session manager operation queue.</span><br><span class="line"></span><br><span class="line"> 从服务器接收到一定数量的字节后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收三个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        接收的数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 该 block 可能会被调用多次，并在会话管理器操作队列中执行</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDataTaskDidReceiveDataBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDataTask</span> *dataTask, <span class="built_in">NSData</span> *data))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed to determine the caching behavior of a data task, as handled by the `NSURLSessionDataDelegate` method `URLSession:dataTask:willCacheResponse:completionHandler:`.</span><br><span class="line"></span><br><span class="line"> 设置确定数据任务的缓存行为执行的 block</span><br><span class="line"> 在 `NSURLSessionDataDelegate` 的 `URLSession:dataTask:willCacheResponse:completionHandler:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed to determine the caching behavior of a data task. The block returns the response to cache, and takes three arguments: the session, the data task, and the proposed cached URL response.</span><br><span class="line"></span><br><span class="line"> 确定数据任务的缓存行为执行的 block 对象</span><br><span class="line"> 该 block 返回要缓存的响应</span><br><span class="line"> 接收三个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        任务</span><br><span class="line">        建议缓存的 URL 响应</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDataTaskWillCacheResponseBlock:(<span class="built_in">NSCachedURLResponse</span> * (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDataTask</span> *dataTask, <span class="built_in">NSCachedURLResponse</span> *proposedResponse))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed once all messages enqueued for a session have been delivered, as handled by the `NSURLSessionDataDelegate` method `URLSessionDidFinishEventsForBackgroundURLSession:`.</span><br><span class="line"></span><br><span class="line"> 设置会话的所有入队消息已经被提交时执行一次的 block</span><br><span class="line"> 在 `NSURLSessionDataDelegate` 的 `URLSessionDidFinishEventsForBackgroundURLSession:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed once all messages enqueued for a session have been delivered. The block has no return value and takes a single argument: the session.</span><br><span class="line"></span><br><span class="line"> 会话的所有入队消息已经被提交时执行一次的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收唯一一个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDidFinishEventsForBackgroundURLSessionBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">///-----------------------------------------------</span></span><br><span class="line"><span class="comment">/// @name Setting Download Task Delegate Callbacks - 设置下载任务代理回调</span></span><br><span class="line"><span class="comment">///-----------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a download task has completed a download, as handled by the `NSURLSessionDownloadDelegate` method `URLSession:downloadTask:didFinishDownloadingToURL:`.</span><br><span class="line"></span><br><span class="line"> 设置下载任务完成后执行的 block</span><br><span class="line"> 在 `NSURLSessionDownloadDelegate` 的 `URLSession:downloadTask:didFinishDownloadingToURL:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a download task has completed. The block returns the URL the download should be moved to, and takes three arguments: the session, the download task, and the temporary location of the downloaded file. If the file manager encounters an error while attempting to move the temporary file to the destination, an `AFURLSessionDownloadTaskDidFailToMoveFileNotification` will be posted, with the download task as its object, and the user info of the error.</span><br><span class="line"></span><br><span class="line"> 下载任务完成后执行的 block 对象</span><br><span class="line"> 该 block 返回下载文件被移动到的 URL</span><br><span class="line"> 接收三个参数</span><br><span class="line"></span><br><span class="line">        session － 会话</span><br><span class="line">        下载任务</span><br><span class="line">        保存下载文件的临时位置</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    如果 FileManager(文件管理器) 将下载文件移动到目标位置时发生错误，会发布一个 `AFURLSessionDownloadTaskDidFailToMoveFileNotification` 通知</span><br><span class="line"></span><br><span class="line">        object - 下载任务</span><br><span class="line">        userInfo - 错误信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDownloadTaskDidFinishDownloadingBlock:(<span class="built_in">NSURL</span> * (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDownloadTask</span> *downloadTask, <span class="built_in">NSURL</span> *location))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed periodically to track download progress, as handled by the `NSURLSessionDownloadDelegate` method `URLSession:downloadTask:didWriteData:totalBytesWritten:totalBytesWritten:totalBytesExpectedToWrite:`.</span><br><span class="line"></span><br><span class="line"> 设置跟踪下载进度重复执行的 block</span><br><span class="line"> 在 `NSURLSessionDownloadDelegate` 的 `URLSession:downloadTask:didWriteData:totalBytesWritten:totalBytesWritten:totalBytesExpectedToWrite:` 代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be called when an undetermined number of bytes have been downloaded from the server. This block has no return value and takes five arguments: the session, the download task, the number of bytes read since the last time the download progress block was called, the total bytes read, and the total bytes expected to be read during the request, as initially determined by the expected content size of the `NSHTTPURLResponse` object. This block may be called multiple times, and will execute on the session manager operation queue.</span><br><span class="line"></span><br><span class="line"> 从服务器下载一定数量的字节后执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收五个参数</span><br><span class="line"></span><br><span class="line">        session - 会话</span><br><span class="line">        下载任务</span><br><span class="line">        从上次下载进度 block 被调用后下载的字节数 － 本次下载字节数</span><br><span class="line">        已经下载的字节数</span><br><span class="line">        请求预期下载的总字节数 - 总下载字节数，由 `NSHTTPURLResponse` 对象的 expectedContentLength 属性确定</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 该 block 可能会被调用多次，并在会话管理器操作队列中执行</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDownloadTaskDidWriteDataBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDownloadTask</span> *downloadTask, int64_t bytesWritten, int64_t totalBytesWritten, int64_t totalBytesExpectedToWrite))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Sets a block to be executed when a download task has been resumed, as handled by the `NSURLSessionDownloadDelegate` method `URLSession:downloadTask:didResumeAtOffset:expectedTotalBytes:`.</span><br><span class="line"></span><br><span class="line"> 设置下载任务续传时执行的 blok</span><br><span class="line"> 在 `NSURLSessionDownloadDelegate` 的 `URLSession:downloadTask:didResumeAtOffset:expectedTotalBytes:` 的代理方法中执行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> @param block A block object to be executed when a download task has been resumed. The block has no return value and takes four arguments: the session, the download task, the file offset of the resumed download, and the total number of bytes expected to be downloaded.</span><br><span class="line"></span><br><span class="line"> 下载任务续传时执行的 block 对象</span><br><span class="line"> 该 block 没有返回值</span><br><span class="line"> 接收四个参数</span><br><span class="line"></span><br><span class="line">        session - 会话</span><br><span class="line">        下载任务</span><br><span class="line">        续传下载的文件偏移位置</span><br><span class="line">        预期下载的总字节数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setDownloadTaskDidResumeBlock:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSession</span> *session, <span class="built_in">NSURLSessionDownloadTask</span> *downloadTask, int64_t fileOffset, int64_t expectedTotalBytes))block;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#endif</span></span><br><span class="line"></span><br><span class="line"><span class="comment">///--------------------</span></span><br><span class="line"><span class="comment">/// @name Notifications - 通知</span></span><br><span class="line"><span class="comment">///--------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a task begins executing.</span><br><span class="line"> 任务开始执行通知</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidResumeNotification` instead.</span><br><span class="line"> 已经废弃，使用 `AFNetworkingTaskDidResumeNotification` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidStartNotification DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a task resumes.</span><br><span class="line"> 任务继续通知</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidResumeNotification;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a task finishes executing. Includes a userInfo dictionary with additional information about the task.</span><br><span class="line"> 任务结束执行通知，任务附加信息包含在 userInfo 字典中</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidCompleteNotification` instead.</span><br><span class="line"> 已经废弃，使用 `AFNetworkingTaskDidCompleteNotification` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidFinishNotification DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a task finishes executing. Includes a userInfo dictionary with additional information about the task.</span><br><span class="line"> 任务结束执行通知，任务附加信息包含在 userInfo 字典中</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidCompleteNotification;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a task suspends its execution.</span><br><span class="line"> 任务暂停执行通知</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidSuspendNotification;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a session is invalidated.</span><br><span class="line"> 网络会话无效通知</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFURLSessionDidInvalidateNotification;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Posted when a session download task encountered an error when moving the temporary download file to a specified destination.</span><br><span class="line"> 会话的下载任务将临时下载文件移动指定目录发生错误通知</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFURLSessionDownloadTaskDidFailToMoveFileNotification;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The raw response data of the task. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if response data exists for the task.</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidCompleteResponseDataKey` instead.</span><br><span class="line"> 请使用 `AFNetworkingTaskDidCompleteResponseDataKey` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidFinishResponseDataKey DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The raw response data of the task. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if response data exists for the task.</span><br><span class="line"> 任务的原始响应数据，如果任务存在响应数据，包含在 `AFNetworkingTaskDidFinishNotification` 的 userInfo 字典中</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidCompleteResponseDataKey;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The serialized response object of the task. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if the response was serialized.</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidCompleteSerializedResponseKey` instead.</span><br><span class="line"> 请使用 `AFNetworkingTaskDidCompleteSerializedResponseKey` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidFinishSerializedResponseKey DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The serialized response object of the task. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if the response was serialized.</span><br><span class="line"> 任务响应数据的反序列化对象，如果响应数据已经被反序列化，包含在 `AFNetworkingTaskDidFinishNotification` 的 userInfo 字典中</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidCompleteSerializedResponseKey;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The response serializer used to serialize the response. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if the task has an associated response serializer.</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidCompleteResponseSerializerKey` instead.</span><br><span class="line"> 请使用 `AFNetworkingTaskDidCompleteResponseSerializerKey` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidFinishResponseSerializerKey DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The response serializer used to serialize the response. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if the task has an associated response serializer.</span><br><span class="line"> 响应序列化器用于反序列化响应数据，如果任务已经关联至响应序列化器，包含在 `AFNetworkingTaskDidFinishNotification` 的 userInfo 字典中</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidCompleteResponseSerializerKey;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The file path associated with the download task. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if an the response data has been stored directly to disk.</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidCompleteAssetPathKey` instead.</span><br><span class="line"> 请使用 `AFNetworkingTaskDidCompleteAssetPathKey` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidFinishAssetPathKey DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> The file path associated with the download task. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if an the response data has been stored directly to disk.</span><br><span class="line"> 与下载任务关联的文件路径，如果响应数据已经被保存至磁盘，包含在 `AFNetworkingTaskDidFinishNotification` 的 userInfo 字典中</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidCompleteAssetPathKey;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Any error associated with the task, or the serialization of the response. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if an error exists.</span><br><span class="line"></span><br><span class="line"> @deprecated Use `AFNetworkingTaskDidCompleteErrorKey` instead.</span><br><span class="line"> 请使用 `AFNetworkingTaskDidCompleteErrorKey` 替代</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidFinishErrorKey DEPRE<span class="built_in">CATED_ATTRIBUTE</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> Any error associated with the task, or the serialization of the response. Included in the userInfo dictionary of the `AFNetworkingTaskDidFinishNotification` if an error exists.</span><br><span class="line"> 与任务或者响应反序列化关联的错误，如果错误存在，包括在 `AFNetworkingTaskDidFinishNotification` 的 userInfo 字典中</span><br><span class="line"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingTaskDidCompleteErrorKey;</span><br></pre></td></tr></table></figure>
<h3 id="2-__u5BF9_u4E8EAFNetworking_2-0_u5C01_u88C5"><a href="#2-__u5BF9_u4E8EAFNetworking_2-0_u5C01_u88C5" class="headerlink" title="2. 对于AFNetworking 2.0封装"></a>2. 对于AFNetworking 2.0封装</h3><p>先挖坑，等具体使用的时候再补充这章的内容。</p>
<p>###参考</p>
<blockquote>
<p><a href="https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-2.0-Migration-Guide" target="_blank" rel="external">https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-2.0-Migration-Guide</a></p>
<p><a href="http://blog.csdn.net/hufengvip/article/details/17338853" target="_blank" rel="external">http://blog.csdn.net/hufengvip/article/details/17338853</a></p>
<p><a href="http://blog.csdn.net/hufengvip/article/details/17338947" target="_blank" rel="external">http://blog.csdn.net/hufengvip/article/details/17338947</a></p>
<p><a href="http://blog.csdn.net/ysysbaobei/article/details/17391081" target="_blank" rel="external">http://blog.csdn.net/ysysbaobei/article/details/17391081</a></p>
<p><a href="http://nshipster.cn/afnetworking-2/" target="_blank" rel="external">http://nshipster.cn/afnetworking-2/</a></p>
<p><a href="http://zhangbuhuai.com/2014/08/03/AFNetworking-20-Tutorial/" target="_blank" rel="external">http://zhangbuhuai.com/2014/08/03/AFNetworking-20-Tutorial/</a></p>
<p><a href="http://blog.jobbole.com/52477/" target="_blank" rel="external">http://blog.jobbole.com/52477/</a></p>
<p><a href="http://www.cnblogs.com/michaellfx/p/2015-3-19-AFNetworking2_5.html" target="_blank" rel="external">http://www.cnblogs.com/michaellfx/p/2015-3-19-AFNetworking2_5.html</a></p>
</blockquote>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/AFNetworking/" rel="tag">#AFNetworking</a>
          
            <a href="/tags/iOS/" rel="tag">#iOS</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/29/2015-07-29-UINavigationBar透明的问题/" rel="next" title="UINavigationBar透明">
                <i class="fa fa-chevron-left"></i> UINavigationBar透明
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/08/10/2015-08-10-objective-c中Model的封装--Mantle学习/" rel="prev" title="objective-c中Model的封装--Mantle学习">
                objective-c中Model的封装--Mantle学习 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


        </div>

        

  <p>热评文章</p>
  <div class="ds-top-threads" data-range="weekly" data-num-items="4"></div>


        
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/08/08/2015-08-08-AFNetworking 2.0框架学习、封装/"
           data-title="AFNetworking学习、封装" data-url="http://yeziahehe.com/2015/08/08/2015-08-08-AFNetworking 2.0框架学习、封装/">
      </div>
    
  </div>


      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="http://7xkvt5.com1.z0.glb.clouddn.com/blog/logo.png" alt="叶帆" itemprop="image"/>
          <p class="site-author-name" itemprop="name">叶帆</p>
        </div>
        <p class="site-description motion-element" itemprop="description">写「优雅」的代码</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">10</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">29</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yeziahehe" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/yeziahehe" target="_blank">
                  
                    <i class="fa fa-linkedin"></i> Linkedin
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/yeziahehe" target="_blank">
                  
                    <i class="fa fa-weibo"></i> Weibo
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-AFURLSessionManager"><span class="nav-number">1.</span> <span class="nav-text">1.AFURLSessionManager</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-__u5BF9_u4E8EAFNetworking_2-0_u5C01_u88C5"><span class="nav-number">2.</span> <span class="nav-text">2. 对于AFNetworking 2.0封装</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">叶帆</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"yeziahehe"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     


    
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.2" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    motionMiddleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');
      if (CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          displaySidebar();
        }
      }
    };
  });
</script>



  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  
  

</body>
</html>
